
处理考勤登入UM:ZHUZHIWEI742    ZHU547869ZHI
原始密码:FE78n5YR6789

代码评审:ZHUZHIWEI742 W547869605w

登入云桌面:ZHUZHIWEI742      Z547869605z


通过vi
1、打开终端命令输入：vi 
2、输入：i
3、输入要保存的内容
4、内容输入完毕后，按esc后输入 ：wq 文件名

＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

设置环境变量

1、打开终端输入－－》vi .bash_profile －－》输入i进入编辑状态
2、设置对应的
e.g:
ANDROID_HOME=/Users/zhiwei_zhu/Desktop/soft_android/android-sdk-macosx
PATH=$PATH:$ANDROID_HOME/tools:$ANDROID_HOME/platform-tools:$ANDROID_HOME/build-tools/23.0.1
export ANDROID_HOME
3、设置好后 退出保存 －－》  按esc 输入 ：wq


＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

更新代码

1\查看分支 git branch -a


1、 执行 命令脚本  ./fmanager pull

2、需要切换到对应的分支 git checout 分支名

3、执行 命令脚本  ./fmanager pull


只更新React native代码: ./fmanager pullrn


＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊

http://10.20.11.218/hyperion/HyperionWiki/wikis/intro_hot-fix-guide#41-android热补丁使用


Config_RELEASE = true
Config_ENV_PRD = true
Config_LOG_ENABLE = false
Config_REACT_DEBUG = false   

备注特别是生产环境包 以上参数配置针对老版本的  

热补丁   

版本号 生产环境  600.1.0
1、 npm run build_android  这一步可以选择性操作   重现构建项目

2、 在项目的根目录执行：./gradlew assembleRelease，执行成功后会生成项目下APK 输入同级目录下：build/outputs/hotfix  文件夹，复制该文件夹出来
	
3、 执行命令：./gradlew clean hotfixReleasePatch -P HotFixDir=RELEASE_HOT_FIX_DIR   RELEASE_HOT_FIX_DIR是路径＝＝第二步复制出来的hotfix文件的路径

4、生成path.jar 后就可以签名了。





1. 首先生产有crash包的hotfix:  根目录下执行命令./gradlew assembleRelease
2. 修复crash  …. 在没有crash的工程里面打补丁:  
3.
4.1.2 打包release包

添加完依赖以后进行release打包，将会在运行目录的build目录下生成hotfix目录

以F项目为例，进行打包后可以找到如下目录

F_Project/paff/build/outputs/hotfix
将hotfix文件夹拷贝与打包的release apk一起保存

4.1.3 修改代码，打包补丁

后续发现bug,修改完项目代码，在项目目录下执行如下命令

./gradlew clean hotfixReleasePatch -P HotFixDir=RELEASE_HOT_FIX_DIR
其中RELEASE_HOT_FIX_DIR为为之前与Release apk一起保存的hotfix文件夹

命令执行完成后，可以在如下目录找到文件patch.jar，即为生成的补丁包

F_Project/paff/build/outputs/hotfix/release/patch.jar
4.1.4 使用APPKEY签名补丁

Android补丁除后台RSA加签外，同时需使用APP发布key签名，增加安全性

补丁包签名机制和apk签名流程一样

jarsigner -verbose -keystore <release_key.keystore> -signedjar signed_patch.jar F_Project/paff/build/outputs/hotfix/release/patch.jar <release_alias>
替换命令中的release_key.keystore和release_alias为APP对应的keystore文件路径和key alias即可

热补丁遇到的问题:

 1\ 因为项目没有引用app 模块 导致热补丁没有进行初始化,出现的现象:app界面提示更新,但是没有改动后的代码效果出现. 
  
 	解决措施:把app/HomeApplication.java/attachBaseContext方法复制到项目中的Application中去进行初始化   


 	 @Override
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(base);
        HFHotFixManager.init(this);

        // 使用热补丁
        FFHotFixManager.applyPatch(this);
    }





**********************************************************************************************************************************************************

windows下的zsh:http://babun.github.io/


*********************************************************************************************************************************************************

打包流程(生成APK\加固\生成渠道包\上传百宝箱site)   登入帐号\密码:paic\paic1234

1\	进入构建站生成对应局点的未签名的APK,自己用选择测试包\发布则选择发布包(要登入,帐号密码都是统一的),生成后下载即可.

2\	找对于接口人进行重签名\加固, 接口人:刘永生，罗前锋，张杰，陈小东 .给他们提供签名文件即可(签名密码:dcWDWCceuDJSC),ok后接口人回传apk.

3\	进入构建站,选择'多渠道包生产',对接口人回传的APK进行生产多渠道包,选择渠道文件代码(markets.txt文件),APK则选择加固后的APK.

4\	生成成功后进入历史多渠道包文件,进行下载,全部都要下载.

5\	全部下载后上传到百宝箱的 site发布包记录里对应局点的文件下. 上传文件列表:1.第一步生成的APK(未加固);
																   2.第二步加固后的APK
																   3.第三步多渠道生成APK
																   4.markets.txt文件

6\	通知相关人员去下载.

********************************************************************************************************************************************************
调试React native 可以试试
adb -s fa435f80 reverse tcp:8081 tcp:8081


*******************************************************************************************************************************************************

查看模块版本再项目的根目录下 modules.json 文件里面查看


*******************************************************************************************************************************************************
上传RN热更新基础包和更新包地址 ----> http://ff-app-cms-stg1.paic.com.cn/web/web/home.html

RN热更新说明:

整体流程：测试高版本热更新验证->生产高版本热更新验证->生产线上版本热更新验证

1  测试高版本热更新验证：

基础包是用旧js代码生成的,更新包是改过后的js代码生成的。

流程：生成热更新基础包和更新包->热更新平台配置测试高版本号->上传基础包和更新包->生成测试高版本apk

热更新基础包：参考wiki:  http://10.20.11.218/FFProject/FFWiki/wikis/rnupdate-android

热更新更新包：参考wiki   http://10.20.11.218/FFProject/FFWiki/wikis/rnupdate-android

热更新平台配置：参考wiki:  http://10.20.11.218/FFProject/FFWiki/wikis/rnupdate-publish

测试高版本apk生成：
1 打开主工程下的 common.gradle ，找到 Config_PACKAGE_TYPE，修改为2，表示不为0的测试环境
2 paff/config.gradle修改versionName为热更新平台配置的高版本号，例如600.0.1
3 AndroidStudio - Build - build APK


2  生产高版本的热更新验证：

流程：获取热更新基础包和生成更新包->基础包和更新包交给田冲上传到生产环境配置平台->生成生产高版本apk

热更新基础包：获取地址：http://10.180.186.140/getapp/output/FProject_android_standard_getapp_git/8577/    最后面的构建号改成你生产发布包在构建站的构建号

热更新更新包：同测试高版本更新包，可直接复用

生产高版本apk生成：
1 打开主工程下的 common.gradle ，找到 Config_PACKAGE_TYPE，修改为1，Config_RELEASE = true，Config_ENV_PRD = true
2 paff/config.gradle修改versionName为热更新平台配置的高版本号，例如600.0.1

3 AndroidStudio - Build - generate signed apk

3  生产线上版本热更新验证：
要走一个签报，具体流程问周勇


生成生产环境包的时候 要用基础包 (http://10.180.186.140/getapp/output/FProject_android_standard_getapp_git/构建号/) 下的基础包解压出来替换app/src/mian/assets/index.android.bundle  文件  

paff/config.gradle 更改版本信息  与打包时候的要一致


工程项目根目录下/common.gradle改为如下:

    Config_RELEASE = true
    Config_ENV_PRD = true
    Config_LOG_ENABLE = true
    Config_REACT_DEBUG = false

************************************************************************************************************************************************

测试环境:
	FConfig.java 文件
		Constant.setReactDebug(false);  // 关闭RN调试
		Constant.updateDebugStatus(true);  // 开启 Log
		Constant.setRnUpdateEnable(true);  // 开启RN热更新

1\ 进入React_native 目录下 输入:npm run package -- --platform android --bundle-output ../app/src/main/assets/index.android.bundle --assets-dest ../app/src/main/res    // 作用:生成测试基础包

app 模块的 assets 目录中会生成index.android.bundle文件,  react_native/bundles/ 目录下也会生成 如: android_1461565042.83 的文件夹,同时react_native/bundles/目录下会有个带时间戳的zip文件,既基础包

2\	对工程代码进行修改,完成修改后可以进行下一步.

3\ 	进入React_native目录 输入:npm run package -- --platform android 命令,生成测试更新包.  
	命令完成后会在  react_native/bundles/ 生成与第一步生成的基础包文件名类似,这个可以根据时间戳来区别. 

4\ 对生产的文件进行测试更新,  在云端电脑(只能在云端)打开浏览器 输入:http://ff-app-cms-stg1.paic.com.cn/web/web/home.html 登入(用户名:chenweixin769 密码:123456)
	选择银行管理--> 目标银行 -->Android端 根据版本选择是否添加版本号 版本号根据生成的apk时候的构建,最后分别上传基础包和更新包,并启用更新包.

5\ 安装测试版APK,对生成的更新包进行测试.  根据测试结果是否继续.

生产环境:

1\ 新的版本需要 再根目录下找到 common.gradle文件,Config_PACKAGE_TYPE 字段 设置值;  测试环境验证热更新：值设为 2 ；生产环境验证热更新：值设为 3 。

2\ 在测试环境下的FConfig.java上的修改改回原来,对于生产环境来说不需要修改,

3\ 进入React_native 目录下 输入:npm run package -- --platform android --bundle-output ../app/src/main/assets/index.android.bundle --assets-dest ../app/src/main/res    // 作用:生成的是生产基础包 (备注:其实不用操作这一步也可以,因为基础包再发布的时候已经有了,直接去取就好了,http://10.180.186.140/getapp/output/FProject_android_standard_getapp_git/7534/   最后面的根据构建号来填写)

app 模块的 assets 目录中会生成index.android.bundle文件,  react_native/bundles/ 目录下也会生成 如: android_1461565042.83 的文件夹,同时react_native/bundles/目录下会有个带时间戳的zip文件,既基础包

4\	对工程代码进行修改,完成修改后可以进行下一步.

5\ 	进入React_native目录 输入:npm run package -- --platform android 命令,生成测试更新包.  
	命令完成后会在  react_native/bundles/ 生成与第一步生成的基础包文件名类似,这个可以根据时间戳来区别. 

6\ 对生成的文件进行测试更新,  在云端电脑(只能在云端)打开浏览器 输入:http://ff-app-cms-stg1.paic.com.cn/web/web/home.html 登入(用户名:chenweixin769 密码:123456)
	选择银行管理--> 目标银行 -->Android端 根据版本选择是否添加版本号 版本号根据生成的apk时候的构建号,最后分别上传基础包和更新包,并启用更新包.


********************************************************************************************************************************************************

git fetch  在新建的一个分支后要切换过去 先执行这一行命令

git checkout master_dev   拉取标版Android代码




********************************************************************************************************************************************************
接入任意门插件需要发邮件给谭莉和赵梅妃 让他们去配置
邮件里面要告诉他们你要接入的插件名称、SDK版本、是哪个SIT、跳转链接（如果有的话）等如
SIT银行：吉林
插件名称：查周边
SDK版本：Q2环境（怎么判断是Q1、Q2、Q3要更加任意门SDK版本来判断）
跳转链接：无
********************************************************************************************************************************************************

http://10.180.184.122:9090/testplan    //测试用例地址 敏捷开发

http://10.180.185.34:8090/dmz/dmz/home.html    //Hy 构建站    zhuzhiwei742  zhuzhiwei742

https://ff-app-sg.pingan.com.cn/dmz/opensso/login.html?service=http%3A%2F%2F10.180.185.34%3A8090%2Fdmz%2Fhome

gitlab  ZHUZHIWEI742   W547869605w

********************************************************************************************************************************************************


jarsigner -verbose -keystore </Users/zhiwei_zhu/Desktop/工作文件/签名\:加固/yzt-jl.keystore> -signedjar signed_patch.jar /Users/zhiwei_zhu/Desktop/吉林热补丁/patch.jar <jilinbank>


********************************************************************************************************************************************************

查看签名信息

keytool -list -v -keystore ./yzt-jl.keystore -storepass dcWDWCceuDJSC

********************************************************************************************************************************************************




https://registry.npm.taobao.org/
https://registry.npmjs.org/


react-native init Navtor --verbose  //新建react native项目时,加上最后面的 --verbose 可以看到详情



********************************************************************************************************************************************************


fdev   ff12345   百宝箱个人

********************************************************************************************************************************************************


https://jcenter.bintray.com   下载aar  arr包


********************************************************************************************************************************************************
	审核视觉包

	1\ 进入构建站,选择对应的site
	2\ 选择第四项 --->  "安全测试包"
	3\ 开始打包即可

********************************************************************************************************************************************************	

